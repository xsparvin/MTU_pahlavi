<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>MTU & VPN Analyzer Enterprise</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@400;700&display=swap" rel="stylesheet">

<style>
:root{
--bg:#020617;--card:#0f172a;--glass:rgba(255,255,255,.12);
--text:#e5e7eb;--muted:#94a3b8;
--accent:#38bdf8;--accent2:#818cf8;
--ok:#4ade80;--bad:#f87171
}
[data-theme="light"]{
--bg:#eef2ff;--card:#fff;--glass:rgba(0,0,0,.08);
--text:#0f172a;--muted:#64748b;
--accent:#2563eb;--accent2:#4f46e5
}
[data-theme="midnight"]{
--bg:#020617;--card:#020617;
--accent:#22d3ee;--accent2:#0ea5e9
}
[data-theme="neon"]{
--bg:#020617;--card:#020617;
--accent:#00ff9c;--accent2:#00e0ff
}
*{box-sizing:border-box}
body{
margin:0;padding:24px;
background:var(--bg);
color:var(--text);
font-family:Vazirmatn
}
.wrap{max-width:1200px;margin:auto}
h1{
text-align:center;
font-size:34px;
background:linear-gradient(90deg,var(--accent),var(--accent2));
-webkit-background-clip:text;color:transparent
}
.card{
background:var(--card);
border:1px solid var(--glass);
border-radius:24px;
padding:24px;margin-bottom:24px
}
.flex{display:flex;gap:12px;flex-wrap:wrap}
.flex>*{flex:1}
label{font-size:13px;font-weight:700;color:var(--muted)}
input,select{
width:100%;padding:14px;margin-top:6px;
border-radius:14px;
border:1px solid var(--glass);
background:rgba(0,0,0,.35);
color:var(--text);
font-family:Inter
}
button{
padding:14px;border-radius:14px;
border:none;font-weight:800;
cursor:pointer;color:#fff
}
.primary{background:linear-gradient(135deg,var(--accent),var(--accent2))}
.stop{background:#ef4444}
.status{text-align:center;font-weight:800;margin-top:12px}
.ok{color:var(--ok)} .err{color:var(--bad)}
canvas{
width:100%;height:300px;
background:rgba(0,0,0,.35);
border-radius:18px;margin-top:16px
}
table{
width:100%;border-collapse:collapse;margin-top:16px
}
th,td{
padding:10px;border-bottom:1px solid var(--glass);
text-align:center;font-size:14px
}
th{color:var(--muted)}
.badge{
display:inline-block;
padding:6px 12px;
border-radius:999px;
background:rgba(255,255,255,.1);
font-size:13px
}
footer{text-align:center;color:var(--muted);font-size:13px}
</style>
</head>

<body data-theme="dark">
<div class="wrap">

<h1>MTU & VPN Analyzer</h1>

<div class="card flex">
<div>
<label>Theme</label>
<select id="theme">
<option value="dark">Dark</option>
<option value="light">Light</option>
<option value="midnight">Midnight</option>
<option value="neon">Neon</option>
</select>
</div>
<div>
<label>VPN Type (Manual)</label>
<select id="vpn">
<option value="0">Auto Detect</option>
<option value="32">WireGuard</option>
<option value="56">IPSec</option>
<option value="60">OpenVPN UDP</option>
<option value="80">OpenVPN TCP</option>
</select>
</div>
</div>

<div class="card">
<div class="flex">
<input id="url" value="https://httpbin.org/bytes/" dir="ltr">
<input id="size" type="number" value="1472" dir="ltr">
</div>
<div class="flex" style="margin-top:12px">
<input id="min" type="number" value="500" dir="ltr">
<input id="max" type="number" value="1500" dir="ltr">
</div>
<div class="flex" style="margin-top:16px">
<button id="run" class="primary">Run</button>
<button id="auto" class="primary">Auto</button>
<button id="stop" class="stop">Stop</button>
</div>

<div id="status" class="status">Ready</div>
<canvas id="chart"></canvas>

<table>
<thead><tr><th>Payload</th><th>Status</th><th>Time</th></tr></thead>
<tbody id="tbody"></tbody>
</table>
</div>

<div class="card">
<h3>ðŸ§  Auto Analysis</h3>
<div id="analysis"></div>
</div>

<footer>Enterprise MTU Analyzer â€¢ xsparvin</footer>
</div>

<script>
const $=i=>document.getElementById(i)
const ctx=$('chart').getContext('2d')
let ctrl=null,running=false,points=[]

$('theme').onchange=e=>document.body.dataset.theme=e.target.value

function draw(){
ctx.clearRect(0,0,ctx.canvas.width,ctx.canvas.height)
if(!points.length)return
const w=ctx.canvas.width,h=ctx.canvas.height
const maxX=Math.max(...points.map(p=>p.x))
const maxY=Math.max(...points.map(p=>p.y||1))

ctx.strokeStyle="rgba(255,255,255,.1)"
for(let i=0;i<5;i++){
ctx.beginPath();ctx.moveTo(0,i*h/5);ctx.lineTo(w,i*h/5);ctx.stroke()
ctx.beginPath();ctx.moveTo(i*w/5,0);ctx.lineTo(i*w/5,h);ctx.stroke()
}

ctx.beginPath()
points.forEach((p,i)=>{
const x=p.x/maxX*w
const y=h-(p.y/maxY*h)
i?ctx.lineTo(x,y):ctx.moveTo(x,y)
})
ctx.strokeStyle="#38bdf8";ctx.stroke()

points.forEach(p=>{
const x=p.x/maxX*w
const y=h-(p.y/maxY*h)
ctx.fillStyle=p.ok?"#4ade80":"#f87171"
ctx.beginPath();ctx.arc(x,y,4,0,Math.PI*2);ctx.fill()
})
}

async function fetchPayload(size){
if(ctrl)ctrl.abort()
ctrl=new AbortController()
const t0=performance.now()
try{
const r=await fetch(`${$('url').value}${size}`,{signal:ctrl.signal})
if(!r.ok)throw''
const b=await r.blob()
if(b.size!==size)throw''
return{ok:true,time:Math.round(performance.now()-t0)}
}catch{return{ok:false}}
}

function log(size,res){
$('tbody').insertAdjacentHTML("afterbegin",
`<tr><td>${size}</td><td class="${res.ok?'ok':'err'}">${res.ok?'OK':'FAIL'}</td><td>${res.time||'-'}</td></tr>`)
points.push({x:size,y:res.time||0,ok:res.ok})
draw()
}

function autoDetect(){
const fails=points.filter(p=>!p.ok).map(p=>p.x)
if(!fails.length)return ''
const avg=fails.reduce((a,b)=>a+b)/fails.length
let type="WireGuard",conf=70
if(avg<1380){type="OpenVPN TCP";conf=85}
else if(avg<1420){type="OpenVPN UDP";conf=80}
else if(avg<1450){type="IPSec";conf=75}
return `Detected VPN: <span class="badge">${type}</span> | Confidence: ${conf}%`
}

$('auto').onclick=async()=>{
if(running)return
running=true
points=[];$('tbody').innerHTML=''
let min=+$('min').value,max=+$('max').value
while(min<=max&&running){
const mid=(min+max)>>1
$('status').innerText=`Testing ${mid}`
const r=await fetchPayload(mid)
log(mid,r)
r.ok?min=mid+1:max=mid-1
await new Promise(r=>setTimeout(r,300))
}
$('analysis').innerHTML=autoDetect()
running=false;$('status').innerText='Ready'
}

$('run').onclick=async()=>{
const r=await fetchPayload(+$('size').value)
log(+$('size').value,r)
}

$('stop').onclick=()=>{if(ctrl)ctrl.abort();running=false;$('status').innerText='Stopped'}
</script>
</body>
</html>